<!DOCTYPE html>
<html>
<head>
    <title>Dados do Google Sheets</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '1078026969554-2snnqosr4kkfu8e5hbdmp7f4keqacmj4.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyA_mIWyn5hyAs3R1BlKWVjlGnNgcojBPf8';
        const DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
        const SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

        function handleClientLoad() {
            gapi.load('client', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function () {
                const accessToken = localStorage.getItem('access_token');
                if (accessToken) {
                    gapi.auth.setToken({ 'access_token': accessToken });
                    listMajors();
                } else {
                    window.location.href = 'login.html';
                }
            }, function(error) {
                console.error(JSON.stringify(error, null, 2));
            });
        }

        function listMajors() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1CcX9EXoBTa3dBP4m0bGFommQ3UmNxCw48wbW0lJbEvo',
                range: 'EA!B6:O46',
            }).then(function(response) {
                const range = response.result;
                if (range.values.length > 0) {
                    let table = document.createElement('table');
                    range.values.forEach((row) => {
                        let tr = document.createElement('tr');
                        row.forEach((cell) => {
                            let td = document.createElement('td');
                            td.textContent = cell;
                            tr.appendChild(td);
                        });
                        table.appendChild(tr);
                    });
                    document.getElementById('content').appendChild(table);
                } else {
                    console.log('No data found.');
                }
            }, function(response) {
                console.error('Error: ' + response.result.error.message);
            });
        }
    </script>
</head>
<body onload="handleClientLoad()">
    <h1>Dados do Google Sheets</h1>
    <div id="content"></div>
</body>
</html>
